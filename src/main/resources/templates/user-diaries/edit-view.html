<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/css/bootstrap.lumen.min.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">
    <title>View & Edit</title>
</head>
<body>
<div th:replace="~{fragments/navbars/user-logged-nav}"></div>

<main>
    <div class="container py-5 mt-5">
        <div class="row">
            <div class="col-10 mx-auto">
                <ul class="nav nav-tabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <a class="nav-link"
                           th:href="'?tab=edit'"
                           th:classappend="${activeTab == 'edit' ? 'active' : ''}">Edit</a>
                    </li>
                    <li class="nav-item" role="presentation">
                        <a class="nav-link"
                           th:href="'?tab=view'"
                           th:classappend="${activeTab == 'view' ? 'active' : ''}">View</a>
                    </li>
                </ul>

                <div class="tab-content border border-top-0 rounded-bottom p-3">
                    <!-- Edit Tab -->
                    <div class="tab-pane fade" id="tabedit" role="tabpanel"
                         th:classappend="${activeTab == 'edit' ? 'show active' : ''}">
                        <form method="post" action="/edit-view/save" enctype="multipart/form-data">
                            <div class="mb-4 w-50 mx-auto">
                                <input type="hidden" id="diaryId" name="diaryId"
                                       th:value="${diaryId == null ? 0 : diaryId}">
                                <input id="titleInput" name="titleInput" class="form-control fs-4" type="text"
                                       placeholder="Diary title" th:value="${title}" required>
                            </div>

                            <div th:each="fragmentModel : ${fragmentModels}">
                                <div th:if="${fragmentModel.getFragmentType() == FragmentType.TEXT_FRAGMENT}"
                                     class="mb-5 d-flex">
                                        <textarea th:id="'content'+${fragmentModel.getId()}"
                                                  th:name="'content'+${fragmentModel.getId()}"
                                                  class="form-control p-3 me-2 fs-5" aria-label="Content"
                                                  placeholder="Write your notes here" style="height: 100px"
                                                  th:text="${fragmentModel.getTextFragment()}"></textarea>

                                    <div class="d-flex flex-column my-auto">
                                        <a th:href="${diaryId}+'?removefragmentid='+${fragmentModel.getId()}"
                                           class="btn btn-light mb-1">
                                            <span th:replace="~{fragments/svg-icons/x-svg}"></span>
                                        </a>
                                        <!--                                            <button class="btn btn-light">-->
                                        <!--                                                <span th:replace="~{fragments/svg-icons/copy-svg}"></span>-->
                                        <!--                                            </button>-->
                                    </div>
                                </div>

                                <div th:if="${fragmentModel.getFragmentType() == FragmentType.IMAGE}"
                                     class="input-group mb-5 d-flex ">
                                    <span class="input-group-text">
                                        <span th:replace="~{fragments/svg-icons/image-file-svg}"></span>
                                    </span>

                                    <input th:id="'image'+${fragmentModel.getId()}"
                                           th:name="'image'+${fragmentModel.getId()}"
                                           class="form-control  form-control-lg rounded-end me-2" type="file"
                                           id="formFile">

                                    <div class="d-flex flex-column my-auto">
                                        <a th:href="${diaryId}+'?removefragmentid='+${fragmentModel.getId()}"
                                           class="btn btn-light mb-1">
                                            <span th:replace="~{fragments/svg-icons/x-svg}"></span>
                                        </a>
                                    </div>
                                </div>

                                <div th:if="${fragmentModel.getFragmentType() == FragmentType.MEDIA_FILE}"
                                     class="input-group mb-5 d-flex ">
                                    <span class="input-group-text">
                                        <span th:replace="~{fragments/svg-icons/media-file-svg}"></span>
                                    </span>

                                    <input th:id="'image'+${fragmentModel.getId()}"
                                           th:name="'image'+${fragmentModel.getId()}"
                                           class="form-control  form-control-lg rounded-end me-2" type="file"
                                           id="mediaFile1">

                                    <div class="d-flex flex-column my-auto">
                                        <a th:href="${diaryId}+'?removefragmentid='+${fragmentModel.getId()}"
                                           class="btn btn-light mb-1">
                                            <span th:replace="~{fragments/svg-icons/x-svg}"></span>
                                        </a>
                                    </div>
                                </div>
                            </div>

                            <div th:if="${diaryId != null && diaryId != 0}"
                                 class="mb-5 d-flex flex-wrap justify-content-between">
                                <div class="input-group input-group-sm w-25 mb-2">
                                    <span class="input-group-text">
                                        <span th:replace="~{fragments/svg-icons/tags-svg}"></span>
                                    </span>
                                    <input type="text" id="newTag" list="datalistTags" class="form-control"
                                           placeholder="Tag"
                                           aria-label="Recipient's username" aria-describedby="button-addon2">
                                    <button class="btn btn-light" type="button" id="addTagButton">
                                        <span th:replace="~{fragments/svg-icons/plus-svg}"></span>
                                    </button>
                                </div>
                                <datalist id="datalistTags">
                                    <option value="Tag 1">
                                    <option value="Tag 2">
                                    <option value="Tag 3">
                                    <option value="Tag 4">
                                    <option value="Tag 5">
                                </datalist>

                                <div th:each="tagModel : ${tagModels}" style="width: 24%;"
                                     class="input-group input-group-sm mb-2">
                                        <span class="input-group-text">
                                            <span th:replace="~{fragments/svg-icons/tag-svg}"></span>
                                        </span>
                                    <input type="text" class="form-control" aria-label="Recipient's username"
                                           aria-describedby="button-addon2" th:value="${tagModel.getContent()}"
                                           disabled>
                                    <a th:href="${diaryId}+'?removetagid='+${tagModel.getId()}"
                                       class="btn btn-light" type="button" id="button-addon2">
                                        <span th:replace="~{fragments/svg-icons/dash-svg}"></span>
                                    </a>
                                </div>
                            </div>

                            <div class="d-flex">
                                <button name="buttonSubmit" type="submit" th:value="save" class="btn btn-primary me-2">
                                    Save
                                </button>

                                <div class="btn-group" role="group" aria-label="Basic example">
                                    <button name="buttonSubmit" type="submit" th:value="newtext" class="btn btn-light">
                                        <span>Add Text</span>&nbsp;<span
                                            th:replace="~{fragments/svg-icons/text-fill-svg}"></span>
                                    </button>
                                    <button name="buttonSubmit" type="submit" th:value="newimage" class="btn btn-light">
                                        <span>Add Image</span>&nbsp;<span
                                            th:replace="~{fragments/svg-icons/image-fill-svg}"></span>
                                    </button>
                                    <button name="buttonSubmit" type="submit" th:value="newmedia" class="btn btn-light">
                                        <span>Add Media</span>&nbsp;<span
                                            th:replace="~{fragments/svg-icons/media-fill-svg}"></span>
                                    </button>
                                </div>

                                <button type="button" th:disabled="${diaryId == null || diaryId == 0}"
                                        class="btn btn-danger ms-2" data-bs-toggle="modal"
                                        data-bs-target="#deleteModal">
                                    Delete
                                </button>
                                <div class="modal fade" id="deleteModal" tabindex="-1"
                                     aria-labelledby="deleteModalLabel" aria-hidden="true">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title" id="deleteModalLabel">Confirm Deletion</h5>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                        aria-label="Close"></button>
                                            </div>
                                            <div class="modal-body">
                                                <span>Are you sure you want to delete the diary titled</span>
                                                <b th:text="${title}"></b><span>?</span>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                                    Cancel
                                                </button>
                                                <form method="post" action="/edit-view/save">
                                                    <button name="buttonSubmit" type="submit" th:value="delete"
                                                            class="btn btn-danger">Confirm
                                                    </button>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <a href="/diaries" class="btn btn-secondary ms-auto">Go Back</a>
                            </div>
                        </form>
                    </div>

                    <!-- View Tab -->
                    <!--                    <div class="tab-pane fade" id="tabview" role="tabpanel"-->
                    <!--                         th:classappend="${activeTab == 'view' ? 'show active' : ''}">-->
                    <!--                        <h1 class="text-center text-dark">Nothing Here Yet</h1>-->
                    <!--                        <p class="text-center text-dark fs-5">Save the information on the Edit tab</p>-->
                    <!--                    </div>-->
                    <div class="tab-pane fade" id="tabview" role="tabpanel"
                         th:classappend="${activeTab == 'view' ? 'show active' : ''}">
                        <h1 class="text-center">Diary Title</h1>
                        <div class="row">
                            <div class="col-11 mx-auto">
                                <div class="mb-3 fs-5 form-control">
                                    <div>Bla is where you display content for viewing.</div>
                                    <div>Lorem ipsum dolor sit amet consectetur adipisicing elit. Sunt, quis
                                        voluptatibus
                                        facilis fugiat molestias ipsum est culpa tenetur cupiditate! Quisquam quis
                                        libero
                                        maxime corrupti quos eos placeat iste necessitatibus soluta?
                                        Rem commodi sunt rerum accusantium enim assumenda quas vel? Assumenda quasi
                                        neque
                                        doloremque iure provident quaerat? Sed consequatur dignissimos laudantium
                                        deleniti
                                        sapiente autem eos voluptate vitae, inventore temporibus exercitationem a.
                                        Voluptate, totam sapiente natus voluptas nulla consectetur provident ad
                                        facere illo
                                        nihil id saepe illum obcaecati enim dolorem tempora nesciunt unde molestiae
                                        quia
                                        distinctio adipisci? Consequatur a labore consequuntur corporis?
                                    </div>
                                    <div>Bla is where you display content for viewing.</div>
                                </div>
                                <div class="mb-3">
                                    <div class="mb-1">
                                        <button class="btn btn-success">
                                            <span th:replace="~{fragments/svg-icons/download-svg}"></span>
                                            <span>&ensp;Download</span>
                                        </button>
                                    </div>
                                    <img class="border border-success img-thumbnail"
                                         src="/assets/example.png"
                                         alt="Example">
                                </div>
                                <div class="mb-3">
                                    <div class="fs-5 form-control">
                                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Consequatur numquam
                                        aperiam illum neque consequuntur! Iure a repellendus provident eligendi
                                        sapiente voluptates, qui ipsam quia sed cumque, nam dolore voluptate
                                        tenetur?
                                    </div>
                                </div>
                                <div class="mb-5 d-flex align-items-center">
                                    <button class="btn btn-success">
                                        <span th:replace="~{fragments/svg-icons/download-svg}"></span>
                                        <span>&ensp;Download</span>
                                    </button>
                                    <div class="ms-2 text-success">
                                        <span th:replace="~{fragments/svg-icons/media-file-svg}"></span>
                                        <span>Media File Name</span>
                                    </div>
                                </div>
                                <div class="mb-2 d-flex flex-wrap">
                                    <div style="width: 24%;" class="input-group input-group-sm mb-2 me-1">
                                            <span class="input-group-text">
                                                <span th:replace="~{fragments/svg-icons/tag-svg}"></span>
                                            </span>
                                        <input type="text" class="form-control" aria-label="Recipient's username"
                                               aria-describedby="button-addon2" value="Tag 1" disabled>
                                    </div>
                                    <div style="width: 24%;" class="input-group input-group-sm mb-2 me-1">
                                            <span class="input-group-text">
                                               <span th:replace="~{fragments/svg-icons/tag-svg}"></span>
                                            </span>
                                        <input type="text" class="form-control" aria-label="Recipient's username"
                                               aria-describedby="button-addon2" value="Tag 1" disabled>
                                    </div>
                                    <div style="width: 24%;" class="input-group input-group-sm mb-2 me-1">
                                            <span class="input-group-text">
                                                <span th:replace="~{fragments/svg-icons/tag-svg}"></span>
                                            </span>
                                        <input type="text" class="form-control" aria-label="Recipient's username"
                                               aria-describedby="button-addon2" value="Tag 1" disabled>
                                    </div>
                                </div>
                                <div class="d-flex">
                                    <div class="input-group input-group-sm me-2">
                                            <span class="input-group-text">
                                                <span th:replace="~{fragments/svg-icons/plus-date-svg}">
                                                </span><span>&ensp;Created Date</span>
                                            </span>
                                        <input type="text" class="form-control" aria-label="Recipient's username"
                                               aria-describedby="button-addon2" value="December 16, 2024, 14:30"
                                               disabled>
                                    </div>
                                    <div class="input-group input-group-sm">
                                            <span class="input-group-text">
                                                <span th:replace="~{fragments/svg-icons/date-check-svg}">
                                                </span><span>&ensp;Last Edit</span>
                                            </span>
                                        <input type="text" class="form-control" aria-label="Recipient's username"
                                               aria-describedby="button-addon2" value="December 16, 2024, 14:30"
                                               disabled>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<script type="application/javascript">
    document.getElementById('addTagButton').addEventListener('click', function () {
        const newTag = document.getElementById('newTag').value.trim();
        const diaryId = document.getElementById('diaryId').value;

        if (newTag) {
            window.location.href = `/edit-view/${diaryId}?addtag=${encodeURIComponent(newTag)}`;
        }
    });
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
</body>

</html>